<!-- paymentSubmission.html -->
<style>
  .form-grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px;}
  .btn{ background:#2962ff;color:#fff;padding:8px 12px;border-radius:6px;border:none;cursor:pointer;}
</style>

<div class="card">
  <h3>Payment Request</h3>
  <form id="payForm">
    <div class="form-grid">
      <div>
        <label>PO ID</label>
        <input id="poId"/>
      </div>
      <div>
        <label>Tranche No</label>
        <input id="tranche" type="number" value="1"/>
      </div>
      <div>
        <label>Amount</label>
        <input id="amount" type="number"/>
      </div>
      <div>
        <label>Mode</label>
        <select id="mode"><option>NEFT</option><option>RTGS</option><option>UPI</option></select>
      </div>
      <div>
        <label>UTR</label>
        <input id="utr"/>
      </div>
      <div>
        <label>Voucher (URL or leave blank)</label>
        <input id="voucherUrl" />
      </div>
    </div>
    <div style="margin-top:12px; text-align:right;">
      <button type="button" class="btn" onclick="submitPaymentRequest()">Request Payment</button>
    </div>
  </form>
</div>

<script>
  function submitPaymentRequest() {
    const payload = {
      poId: document.getElementById('poId').value,
      trancheNo: document.getElementById('tranche').value,
      amount: document.getElementById('amount').value,
      mode: document.getElementById('mode').value,
      utr: document.getElementById('utr').value,
      voucherFileId: '', // if you implement upload
      voucherFileUrl: document.getElementById('voucherUrl').value,
      remarks: ''
    };
    google.script.run.withSuccessHandler(function(resp){
      alert('Payment request created: ' + resp.payId);
      location.reload();
    }).withFailureHandler(function(e){ alert(e.message); }).requestPayment(payload);
  }
</script>
